\pgfplotstableset{
    begin table=\begin{longtable},
    end table=\end{longtable},
}
\sisetup{
	table-format = 3.2e+3,
	round-precision=2,
	round-mode=places,
	scientific-notation=engineering,
	%round-integer-to-decimal,
	%group-separator = \text{~},
	%input-decimal-markers={.},
	group-digits=integer,
	group-separator={,},
	exponent-product = \cdot,
}
\pgfkeys{/pgf/number format/set thousands separator={,}}

\chapter{OpenMP Prefix Sums}

\pgfplotstableread[format=file]{../../../data/1-openmp/p1/size-prefix-sum.plot}\loadedtable

\begin{figure}[h!]
\centering
\small{
\setlength\tabcolsep{10pt} % wider table
\pgfplotstabletypeset[
	header=true,
	string type,
	multicolumn names, % make siunitx happy
	columns={size,med,min,avg,max},
	assign column name/.code={%
		\pgfkeyssetvalue{/pgfplots/table/column name}{\multicolumn{1}{c}{\multirow{2}{*}{#1}} }%
	},
	columns/size/.style ={column name={\textstackrel{Instance}{Size}}, column type={S[scientific-notation=false,table-format=9]}, int detect},
	columns/min/.style ={column name=Minimum,	column type=S},
	columns/avg/.style ={column name=Average,	column type=S},
	columns/med/.style ={column name=Median,	column type=S},
	columns/max/.style ={column name=Maximum,	column type=S},
	every head row/.style={before row=\toprule, after row=\\\midrule\endhead},
	every last row/.style={after row=\bottomrule},
	skip rows between index={1}{2},
]{\loadedtable}
}\vskip 1.2 cm
\begin{tikzpicture}
\begin{axis}[
	width=0.8\linewidth,
	xlabel={Instance Size [array elements]},
	ylabel={Time [s]},
	legend entries={below median,median, above median},
	xmode=log, ymode=log,
	enlarge x limits=false,
	axis on top,
	legend style={
		draw=none,
		cells={anchor=west},
		legend pos=north west,
		},
	reverse legend,
	ymin=0,
	]
	\addplot [stack plots=y, fill=none, draw=none, forget plot] 			table [x=size, y=min]								{\loadedtable} \closedcycle;
	\addplot [stack plots=y, fill=green!40, draw opacity=0, area legend]	table [x=size, y expr=\thisrow{med}-\thisrow{min}]	{\loadedtable} \closedcycle;
	\addplot [stack plots=false, draw=black, thick]							table [x=size, y=med]								{\loadedtable};
	\addplot [stack plots=y, fill=red!40, draw opacity=0, area legend]		table [x=size, y expr=\thisrow{max}-\thisrow{med}]	{\loadedtable} \closedcycle;
\end{axis}
\end{tikzpicture}
\caption{Benchmark results showing \textbf{run time per instance size} of the \textbf{Auxiliary Array algorithm} solving the \textbf{Prefix Sums problem} in \textbf{OpenMP}.}
\label{plot:1-1-1-size}
\end{figure}
\clearpage
\cite{fiberbyte}

